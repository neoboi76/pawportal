 <!-- Developed by Group 6:
    Kenji Mark Alan Arceo
    Carl Norbi Felonia
    Ryonan Owen Ferrer
    Dino Alfred Timbol
    Mike Emil Vocal  -->

<title>Dog Management</title>

<div class="min-h-screen bg-[#F9FAFB]">
  <div class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-3xl font-bold text-[#1A1A1A]">Manage Dogs</h1>
          <p class="text-gray-600 mt-1">Add, edit, or remove dogs from the system</p>
        </div>
        <button (click)="openAddModal()"
                class="cursor-pointer bg-[#1E88E5] text-white px-6 py-3 rounded-lg font-semibold hover:bg-[#1976D2] transition-colors">
          <i class="fas fa-plus mr-2"></i>Add New Dog
        </button>
      </div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-xl shadow-md p-6 mb-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
        <div class="md:col-span-2">
          <input type="text" 
                [(ngModel)]="searchTerm"
                (ngModelChange)="applyFilters()"
                placeholder="Search by name or breed..."
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
        </div>
        <div>
          <select [(ngModel)]="filterStatus"
                  (ngModelChange)="applyFilters()"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
            <option value="">All Status</option>
            <option value="AVAILABLE">Available</option>
            <option value="PENDING">Pending</option>
            <option value="ADOPTED">Adopted</option>
          </select>
        </div>
      </div>
      
      <div class="flex gap-4">
        <button (click)="exportDogsToCSV()"
                class="cursor-pointer px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200">
          <i class="fas fa-file-csv mr-2"></i>Export to CSV
        </button>
        <button (click)="clearFilters()"
                class="cursor-pointer px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors duration-200">
          Clear Filters
        </button>
      </div>
    </div>

    @if (successMessage) {
      <div class="mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
        {{ successMessage }}
      </div>
    }

    @if (errorMessage) {
      <div class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
        {{ errorMessage }}
      </div>
    }

    @if (isLoading) {
      <div class="flex justify-center items-center py-20">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#1E88E5]"></div>
      </div>
    } @else if (filteredDogs.length > 0) {
      <div class="bg-white rounded-xl shadow-lg overflow-hidden">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dog</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Breed</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Age</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              @for (dog of filteredDogs; track dog.dogId) {
                <tr class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <img [src]="dog.imageUrl" [alt]="dog.name" class="w-12 h-12 rounded-lg object-cover">
                      <div class="ml-4">
                        <div class="text-sm font-medium text-gray-900">{{ dog.name }}</div>
                        <div class="text-sm text-gray-500">{{ dog.gender }}</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">{{ dog.breed }}</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">{{ dog.age }} years</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">{{ dog.size }}</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span [ngClass]="{
                      'bg-green-100 text-green-800': dog.status === 'AVAILABLE',
                      'bg-yellow-100 text-yellow-800': dog.status === 'PENDING',
                      'bg-blue-100 text-blue-800': dog.status === 'ADOPTED'
                    }" class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full">
                      {{ dog.status }}
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button (click)="openEditModal(dog)"
                            class="cursor-pointer text-[#1E88E5] hover:text-[#1665b5] mr-4">
                      <i class="fas fa-edit"></i> Edit
                    </button>
                    <button (click)="confirmDelete(dog)"
                            class="cursor-pointer text-red-600 hover:text-red-900">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    } @else {
      <div class="bg-white rounded-xl shadow-lg p-12 text-center">
        <i class="fas fa-dog text-6xl text-gray-400 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-700 mb-2">No Dogs Found</h3>
        <p class="text-gray-600 mb-6">Start by adding your first dog to the system</p>
        <button (click)="openAddModal()"
                class="cursor-pointer bg-[#1E88E5] text-white px-6 py-3 rounded-lg font-semibold hover:bg-[#1976D2]">
          Add New Dog
        </button>
      </div>
    }
  </div>
</div>

@if (showModal) {
  <div class="fixed inset-0 z-50 overflow-y-auto animate-fadeIn">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:p-0">
      <div class="fixed inset-0 bg-opacity-75 z-40 bg-black/60 backdrop-blur-sm transition-opacity duration-300" (click)="closeModal()"></div>
      
      <div class="relative inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full z-50 animate-scaleIn"
           (click)="$event.stopPropagation()">
        
        <form [formGroup]="dogForm" (ngSubmit)="submitForm()">
          <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">
              {{ isEditMode ? 'Edit Dog' : 'Add New Dog' }}
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Name *</label>
                <input type="text" formControlName="name"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
                @if (f['name'].errors && f['name'].touched) {
                  <p class="text-red-500 text-sm mt-1">Name is required</p>
                }
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Breed *</label>
                <input type="text" formControlName="breed"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Age (years) *</label>
                <input type="number" formControlName="age" min="0" max="20"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
                @if (isSubmitted && f['age'].errors) {
                  <p class="text-red-500text-red-500">>Valid age required (0-20)Valid age required (0-20)</p>
                  }
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Gender *</label>
                <select formControlName="gender"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Size *</label>
                <select formControlName="size"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
                  <option value="SMALL">Small</option>
                  <option value="MEDIUM">Medium</option>
                  <option value="LARGE">Large</option>
                  <option value="EXTRA_LARGE">Extra Large</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Status *</label>
                <select formControlName="status"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
                  <option value="AVAILABLE">Available</option>
                  <option value="PENDING">Pending</option>
                  <option value="ADOPTED">Adopted</option>
                </select>
              </div>

              <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-2">Image URL *</label>
                <input type="text" formControlName="imageUrl"
                       placeholder="https://example.com/image.jpg"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
              </div>

              <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-2">Description *</label>
                <textarea formControlName="description" rows="3"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none"></textarea>
              </div>

              <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-2">Temperament</label>
                <input type="text" formControlName="temperament"
                       placeholder="Friendly, Playful, Energetic"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1E88E5] focus:outline-none">
              </div>

              <div class="flex items-center">
                <input type="checkbox" formControlName="vaccinated" id="vaccinated"
                       class="w-4 h-4 text-[#1E88E5] border-gray-300 rounded focus:ring-[#1E88E5]">
                <label for="vaccinated" class="ml-2 block text-sm text-gray-900">Vaccinated</label>
              </div>

              <div class="flex items-center">
                <input type="checkbox" formControlName="spayedNeutered" id="spayedNeutered"
                       class="w-4 h-4 text-[#1E88E5] border-gray-300 rounded focus:ring-[#1E88E5]">
                <label for="spayedNeutered" class="ml-2 block text-sm text-gray-900">Spayed/Neutered</label>
              </div>
            </div>

            @if (successMessage) {
              <div class="mt-4 p-3 bg-green-100 text-green-700 rounded-lg text-sm">
                {{ successMessage }}
              </div>
            }

            @if (errorMessage) {
              <div class="mt-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm">
                {{ errorMessage }}
              </div>
            }
          </div>

          <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse gap-3">
            <button type="submit"
                    [disabled]="dogForm.invalid"
                    class="cursor-pointer w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-[#1E88E5] text-base font-medium text-white hover:bg-[#1976D2] focus:outline-none sm:w-auto sm:text-sm disabled:bg-gray-400 disabled:cursor-not-allowed">
              {{ isEditMode ? 'Update' : 'Add' }} Dog
            </button>
            <button type="button" (click)="closeModal()"
                    class="cursor-pointer mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:w-auto sm:text-sm">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
}

@if (showDeleteConfirm) {
  <div class="fixed inset-0 z-50 overflow-y-auto animate-fadeIn">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20  bg-black/60 backdrop-blur-sm transition-opacity duration-300">
      <div class="fixed inset-0bg-opacity-75 z-40 transition-opacity duration-300 ease-out animate-fadeIn" (click)="cancelDelete()"></div>
      
      <div class="relative inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full z-50 animate-scaleIn"
           (click)="$event.stopPropagation()">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6">
          <div class="sm:flex sm:items-start">
            <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0">
              <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
            </div>
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
              <h3 class="text-lg leading-6 font-medium text-gray-900">Delete Dog</h3>
              <div class="mt-2">
                <p class="text-sm text-gray-500">
                  Are you sure you want to delete <strong>{{ dogToDelete?.name }}</strong>? This action cannot be undone.
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse gap-3">
          <button type="button" (click)="deleteDog()"
                  class="cursor-pointer w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none sm:w-auto sm:text-sm">
            Delete
          </button>
          <button type="button" (click)="cancelDelete()"
                  class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:w-auto sm:text-sm">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>
}